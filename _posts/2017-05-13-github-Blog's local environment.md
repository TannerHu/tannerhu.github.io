---
layout:     post
title:      GitHub上博客的本地环境构建（2）
date:       2017/5/13 16:01:18   
author:     Tanner Hu
summary:    新手GitHub搭建Blog
categories: jekyll
thumbnail:  cogs
tags:
 - GitHub
 - 博客
 - 本地环境构建
---
# 本地环境构建 #

这一步虽然不是必须的，但是博客搭建起来后，做框架更改时或者写完文章想看下文章在页面的排版和显示状况时，本地测试环境就非常重要。

如果完全靠html来编辑博客，随博客越来越复杂时，维护起来的工作量会非常大。所以需要用到jekyll这个版模引擎来帮忙维护。首篇就先介绍使用jekyll的本地环境搭建。

# Ruby安装 #

jekyll并没有正式支持Windows，但jekyll本身基于Ruby开发，因此，想要在本地构建一个测试环境需要具有Ruby的开发和运行环境。在winddow下，可以使用[RubyInstaller][1]进行无脑安装~我用的是Ruby 2.2.6 的32位版本![Thumper](http://wx3.sinaimg.cn/mw690/692c65a4gy1ffjvh227o3j20fe0bm74r.jpg)

其他系统的可以参考[ruby安装说明][2]

# RubyDevKit安装 #

我刚刚安装的是Ruby 2.2.6的32位版，所以对应的[DevKit][3]是
![Thumper](http://wx4.sinaimg.cn/mw690/692c65a4gy1ffjw3ixed5j20g90a0gm6.jpg)

下载下来的是**sfx.exe**文件，如果你安装有**7-zip**，可以直接双击，它会自解压到你所选择的目录。

解压完后，在你刚刚选的解压目录下下按Shift+鼠标右键，选在此处打开命令窗口，或者可以打开cmd后cd到你刚刚选的解压目录。
然后输入下面命令，该命令会生成**config.yml**。：


    ruby dk.rb init

**config.yml**文件实际上是检测系统安装的ruby的位置并记录在这个文件中，以便稍后使用。但上面的命令只针对使用rubyinstall安装的ruby有效，如果是其他方式安装的话，需要手动修改**config.yml**。我生成的**config.yml**文件内容如下（注意路径用的是linux的斜杠方向）：
    

    # This configuration file contains the absolute path locations of all
    # installed Rubies to be enhanced to work with the DevKit. This config
    # file is generated by the 'ruby dk.rb init' step and may be modified
    # before running the 'ruby dk.rb install' step. To include any installed
    # Rubies that were not automagically discovered, simply add a line below
    # the triple hyphens with the absolute path to the Ruby root directory.
    #
    # Example:
    #
    # ---
    # - C:/ruby19trunk
    # - C:/ruby192dev
    #
    ---
    - D:/Github/Ruby22

最后，输入如下命令，执行安装：

    ruby setup.rb

如果没有setup.rb的话，执行：

    ruby dk.rb install

# Rubygems #
Rubygems是类似Radhat的RPM、centOS的Yum、Ubuntu的apt-get的应用程序打包部署解决方案。Rubygems本身基于Ruby开发，在Ruby命令行中执行。我们需要它主要是因为jekyll的执行需要依赖很多Ruby应用程序，如果一个个手动安装比较繁琐。jekyll作为一个Ruby的应用，也实现了Rubygems打包标准。只要通过简单的命令就可以自动下载jekyll依赖的Ruby应用程序。

[Rubygems][4]点击链接进入后下载**ZIP**文件解压到你要安装的目录下然后用cmd在这个个目录下输入：

    ruby setup.rb

就像yum仓库一样，仓库本身有很多，如果希望加快应用程序的下载速度，特别绕过“天朝”的网络管理制度，可以选择国内的仓库镜像，以前taobao镜像不维护了现在用 [Ruby China][5] 的镜像，配置方法这个链接里面很全，**但是添加和移除镜像地址时网址上给的命令是**：

    gem sources --add https://gems.ruby-china.org/ --remove https://rubygems.org/

我是没添加成功的要改成：

    gem sources --add http://gems.ruby-china.org/ --remove https://rubygems.org/

也就是添加时把`https`改成`http`移除没问题。

# 安装jekyll #

有了上面的基础，安装jekyll就十分轻松了，在cmd里执行下面gem命令即可全自动搞定：

    gem install jekyll

# 安装Bundle #

在cmd里执行下面gem命令：

    gem install bundle



# 用现成的模板测试jekyll服务 #

博客基于jekyll，而新手往往摸不着头脑，幸好有一些现成的模板可以直接使用，先在[Jekyll Themes][6]下载个自己喜欢的版模：
![Thumper](http://wx2.sinaimg.cn/mw690/692c65a4gy1ffjztxb7bzj20yd0mqmz3.jpg)

这些版模只要改些配置文件就能直接用的怎么改后面说了，这里只是先测试下本地环境。下载一个版模后解压，进到解压出文件夹的根目录下创建一个叫`Gemfile`的文件，注意没有后缀，
可以先建一个**txt**文件然后输入：

    source 'http://gems.ruby-china.org/'
    gem 'github-pages'

保存后重命名为`Gemfile`把后缀`.txt`删了。

![Thumper](http://wx4.sinaimg.cn/mw690/692c65a4gy1ffk1kv3h2nj20ll0gj768.jpg)

然后在保存的根目录下按Shift+鼠标右键,打开命令窗口执行：

    bundle install

命令会根据当前目录下的Gemfile，安装所需要的所有软件。这一步所安装的东西，可以说跟github本身的环境是完全一致的，所以可以确保本地如果没有错误，上传后也不会有错误。而且可以在将来使用下面命令，随时更新环境，十分方便：

    bundle update

使用下面命令，启动转化和本地服务：

    bundle exec jekyll serve

![Thumper](http://wx2.sinaimg.cn/mw690/692c65a4gy1ffk1xir31tj20t90hs0w2.jpg)

在浏览器地址里输入上面显示**Server address**地址就可以打开本地生成页面了。
在cmd下按Ctrl+c停止运行服务。

[GitHub上博客的搭建-前言（1）][7] ; [GitHub上博客的本地环境构建（2）][8] ; [GitHub-博客搭建（3）][9] ; [GitHub-博客域名设置（4）][10]

[1]: http://rubyinstaller.org/downloads/
[2]: http://www.ruby-lang.org/zh_cn/downloads/
[3]: http://rubyinstaller.org/downloads/
[4]: https://rubygems.org/pages/download/
[5]: http://gems.ruby-china.org/
[6]: http://jekyllthemes.org/
[7]: /jekyll/2017/05/11/guithub-Blog-to-build-preface/
[8]: /jekyll/2017/05/13/github-Blog's-local-environment/
[9]: /jekyll/2017/05/14/github-Blog-home-page-created/
[10]: /jekyll/2017/05/15/github-Blog-domain-name-setting/